<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand"  routerLink="/home">LoanHub</a>
      <div class="navbar-collapse collapse justify-content-end">
        <div class="navbar-text me-3">
          <i class="fas fa-user"></i> 
          Welcome, {{ userName }}!
        </div>
        <button class="btn btn-outline-light" (click)="logout()">Logout</button>
      </div>
    </div>
  </nav>
  
<div class="container">
    <h2>Your Loan Applications</h2>
    
    <!-- Search Box -->
    <div class="input-group mb-3">
        <span class="input-group-text" id="basic-addon1">
          <i class="fas fa-search"></i> <!-- Font Awesome search icon -->
        </span>
        <input
          type="text"
          class="form-control"
          placeholder="Search..."
          [(ngModel)]="searchTerm" 
          (ngModelChange)="filterApplications()" 
          aria-label="Search"
          aria-describedby="basic-addon1"
        />
    </div>

  
    <div *ngIf="loading" class="loading-spinner"></div>
    <div *ngIf="!loading && filteredApplications.length === 0">
      <p>No loan applications found.</p>
    </div>
    <table *ngIf="!loading && filteredApplications.length > 0" class="table table-striped">
      <thead>
        <tr>
          <th>Application ID</th>
          <th>Application Date</th>
          <th>Loan Amount</th>
          <th>Loan Status</th>
          <th>Verification Status</th>
          <th>Repayment Start Date</th>
          <th>User Address</th>
          <th>Nominee Name</th>
          <th>Document</th>
          <th>Approve</th>
          <th>Reject</th>
          <th>View Collateral</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let application of filteredApplications; let i = index">
          <td>{{ i + 1 }}</td>
          <td>{{ application.applicationDate | date }}</td>
          <td>{{ application.loanAmount | currency }}</td>
          <td>{{ application.loanStatus }}</td>
          <td>{{ application.documentVerificationStatus }}</td>
          <td>{{ application.repaymentStartDate | date }}</td>
          <td>{{ application.userAddress }}</td>
          <td>{{ application.nomineeName }}</td>
          <td>
            <button (click)="viewDocument(application)" class="btn btn-info">View Document</button>
          </td>
          <td>
            <button (click)="approveLoan(application.loanApplicationId)" class="btn btn-primary">Approve</button>
          </td>
          <td>
            <button (click)="rejectLoan(application.loanApplicationId)" class="btn btn-danger">Reject</button>
          </td>
          <td>
            <button [disabled]="application.documentVerificationStatus !== 'Completed'" (click)="ViewCollateral1(application)" class="btn btn-primary">View</button>
          </td>
        </tr>
      </tbody>
    </table>
    <div class="text-center mt-4">
      <button 
          routerLink="/loan-officer" 
          class="btn btn-secondary" 
          style="background-color: #6c757d; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer;">
          Back to Dashboard
      </button>
  </div>
    <mat-paginator
    [length]="totalCount"
    [pageSize]="pageSize"
    [pageSizeOptions]="[3, 5, 10]"
    (page)="onPageChange($event)">
    </mat-paginator>
  
    
    <div *ngIf="showCollateralModal" class="collateral-modal">
      <div class="modal-content">
        <h3>Collateral Documents</h3>
        <button (click)="closeCollateral()" class="btn btn-danger">Close</button>
        
        <ng-container *ngIf="selectedCollateral">
          <strong>Document Type:</strong> {{ selectedCollateral.documentType }} <br />
          <strong>File Name:</strong> {{ selectedCollateral.fileName }} <br />
          <strong>File Content:</strong>
          <ng-container >
            <a [href]="selectedCollateral.base64FileContent" target="_blank" rel="noopener noreferrer">Open Document</a>
          </ng-container>
          <ng-template #base64Content>
            <ng-container *ngIf="selectedCollateral.documentType === 'png'">
              <img [src]="selectedCollateral.base64FileContent" 
                   alt="{{ selectedCollateral.fileName }}" 
                   style="max-width: 300px; max-height: 300px;" />
            </ng-container>
            <ng-container *ngIf="selectedCollateral.documentType !== 'png'">
              <a [href]="selectedCollateral.base64FileContent" target="_blank" rel="noopener noreferrer">View Document</a>
            </ng-container>
          </ng-template>
        </ng-container>
        
    
    
 
  </div>
  