<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container-fluid">
      <a class="navbar-brand"  routerLink="/home">LoanHub</a>
      <div class="navbar-collapse collapse justify-content-end">
        <div class="navbar-text me-3">
          <i class="fas fa-user"></i> 
          Welcome, {{ userName }}!
        </div>
        <button class="btn btn-outline-light" (click)="logout()">Logout</button>
      </div>
    </div>
  </nav>

<div class="container">
    <h2>Your Loan Applications</h2>
    <div class="input-group mb-3">
        <span class="input-group-text" id="basic-addon1">
          <i class="fas fa-search"></i> <!-- Font Awesome search icon -->
        </span>
        <input
          type="text"
          class="form-control"
          placeholder="Search..."
          [(ngModel)]="searchTerm" 
          aria-label="Search"
          aria-describedby="basic-addon1"
        />
      </div>

    <div *ngIf="loading" class="loading-spinner"></div>
    <div *ngIf="!loading && paginatedLoanSchemes.length === 0">
        <p>No loan applications found.</p>
    </div>
    <table *ngIf="!loading && paginatedLoanSchemes.length > 0" class="table">
        <thead>
            <tr>
                <th>Index No</th>
                <th>Application Date</th>
                <th>Loan Amount</th>
                <th>Loan Status</th>
                <th>Verification Status</th>
                <th>Repayment Start Date</th>
                <th>User Address</th>
                <!-- <th>Document File</th> -->
                <th>Nominee Name</th>
                <th>Actions</th> 
                <th>Upload Collateral</th>
                <th >Pay</th>
            </tr>
        </thead>
        <tbody>
            <tr *ngFor="let application of paginatedLoanSchemes; let i = index">
                <td>{{ i+1}}</td>
                <td>{{ application.applicationDate | date }}</td>
                <td>{{ application.loanAmount }}</td>
                <td>{{ application.loanStatus }}</td>
                <td>{{application.documentVerificationStatus}}</td>
                <td>{{ application.repaymentStartDate | date }}</td>
                <td>{{ application.userAddress }}</td>
                <!-- <td>{{ application.documentFileName1 }}</td> -->
                <td>{{ application.nomineeName }}</td>

                <td>
                    <!-- Button to view document -->
                    <button (click)="viewDocument(application)" class="btn btn-info">View Document</button>
                </td>
                <td>
                  <button 
                    class="btn btn-primary" 
                    [routerLink]="['../collateral', application.loanApplicationId]" 
                    [disabled]="application.documentVerificationStatus !== 'Completed'">
                    upload Collateral
                  </button>
                </td>
                <td>
                  <button 
                    class="btn btn-primary" 
               
                    [routerLink]="['../repayment', application.loanApplicationId]" 
                    [disabled]="application.loanStatus !== 'granted'">
                    Pay
                  </button>
                </td>
            </tr>
        </tbody>
    </table>
    <div class="pagination mt-4">
      <button 
        class="btn btn-secondary" 
        [disabled]="page === 1" 
        (click)="previousPage()">
        <i class="fas fa-arrow-left"></i> 
      </button>
      <span class="mx-2">Page {{ page }} of {{ totalPages }}</span>
      <button 
        class="btn btn-secondary" 
        [disabled]="page === totalPages" 
        (click)="nextPage()">
        <i class="fas fa-arrow-right"></i>
      </button>
    </div>
    <div class="text-center mt-4">
        <button routerLink="/dashboard" class="btn btn-secondary">Back to Dashboard</button>
    </div>
</div>
